<div class="row body-content">

  <!-- RSVP ID Area -->
  <div class="col-xs-12" *ngIf="!rsvp && !success">
    <form #rsvpForm="ngForm" (ngSubmit)="fetchRSVP()" autocomplete="off">
      <div class="form-group">
        <label for="rsvpId">Enter your RSVP number</label>
        <input type="text" class="form-control" id="rsvpId"
               required
               [(ngModel)]="rsvpId"
               name="rsvpId"
               maxlength="5"
               minlength="5">
        <div *ngIf="formSubmissionError">You entered in an invalid rsvp id!</div>

      </div>

      <button type="submit" class="btn btn-success" [disabled]="!rsvpForm.valid">Submit</button>
    </form>
  </div>

  <!-- Confirm RSVP Area -->
  <div class="col-xs-12" *ngIf="rsvp && !success">
    <form [formGroup]="confirmRsvp" (ngSubmit)="confirmRSVP()" autocomplete="off">
      <h2>Welcome {{rsvp.first}} {{rsvp.last}}!</h2>
      <p>We've reserved {{rsvp.numberOfGuests + 1}} seat{{rsvp.numberOfGuests > 0 ? 's' : ''}} for you.</p>
      <p>Will you be joining us for this occasion?</p>

      <section>
        <input type="radio" [value]="true" name="attending" formControlName="attending"> Hell yeah I am!
        <input type="radio" [value]="false" name="attending" formControlName="attending"> Nah, I'm lame.
      </section>

      <div *ngIf="confirmRsvp.controls.numberOfGuests.value > 0">
        <p> Will you be bringing a guest?</p>
        <input type="checkbox" formControlName="bringingGuest" (change)="updateBringingGuest()" />
      </div>

      <div formArrayName="guests" *ngIf="confirmRsvp.controls.bringingGuest.value">
        <div *ngFor="let guest of confirmRsvp.controls.guests.controls; let i = index">
          <p *ngIf="i === 0">Please let us know below if your guests will be attending.</p>
          <div [formGroupName]="i">
            <label>Guest's First Name</label>
            <input type="text"
                   class="form-control"
                   name="guestFirstName{{i}}"
                   formControlName="first" />
            <label>Guest's Last Name</label>
            <input type="text"
                   class="form-control"
                   name="guestLastName{{i}}"
                   formControlName="last" />
          </div>
          <a (click)="removeGuest(i)">Remove guest</a>

        </div>
        <a *ngIf="confirmRsvp.controls.numberOfGuests.value > confirmRsvp.controls.guests.length" (click)="addGuest()">Add another guest</a>
      </div>

      <button type="submit" class="btn btn-success" [disabled]="!confirmRsvp.valid">{{ rsvp.guests && rsvp.guests.length > 0 ? "Update" : "Submit" }}  </button>

      <div>{{ confirmRsvp.value | json }}</div>

    </form>
  </div>

  <!-- Success area -->
  <div class="col-xs-12" *ngIf="success">
    You have successfully RSVP'ed! We look forward to seeing you on March 16th, 2019!
  </div>
</div>
